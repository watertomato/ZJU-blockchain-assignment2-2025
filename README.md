# ZJU-blockchain-course-2025

⬆ 可以️修改成你自己的项目名。

> 第二次作业要求（以下内容提交时可以删除）：
> 
> 进阶的去中心化彩票系统，参与方包括：竞猜玩家、公证人
>
> **背景**：传统的体育彩票系统（例如我国的体育彩票）一般没有彩票交易功能：例如，对于“NBA本赛季MVP为某球员/F1的赛季总冠军为某车队”这类持续时间长的事件的下注一般在赛季开始前就会买定离手，这使得一旦出现突发或不确定事件（如球员A赛季报销/球队B买入强力球星/C车队车手受伤等），很多玩家的选择便会立即失去意义，导致彩票游戏的可玩性下降。因此，一个有趣的探索方向是让彩票系统拥有合规、方便的交易功能。
>
> 建立一个进阶的去中心化彩票系统（可以是体育彩票，或其它任何比赛节目的竞猜，例如《中国好声音》《我是歌手》年度总冠军等，可以参考 [Polymarket](https://polymarket.com/) ），在网站中：
> - 公证人（你自己）可以创立许多竞猜项目：例如某场比赛的输赢、年度总冠军的得主等，每个项目应当有2个或多个可能的选项，一定的彩票总金额（由公证人提供），以及规定好的结果公布时间。
> - 玩家首先领取到测试所需以太币。在网站中，对于一个竞猜项目和多个可能的选项：
>   1. 每个竞彩玩家都可以选择其中的某个选项并购买一定金额（自己定义）的彩票，购买后该玩家会获得一张对应的彩票凭证（一个 ERC721 合约中的 Token）
>   2. 在竞彩结果公布之前，任何玩家之间可以买卖他们的彩票，以应对项目进行期间的任何突发状况。具体的买卖机制如下：一个玩家可以以指定的金额挂单出售（ERC721 Delegate）自己的彩票，其它玩家如果觉得该彩票有利可图就可以买入他的彩票。双方完成一次 ERC721 Token 交易。
>   3. 公证人可以在时间截止时（简单起见，你可以随时终止项目）输入竞猜的结果并进行结算。所有胜利的玩家可以平分奖池中的金额。
> - Bonus（最多5分，若想要完成，可以直接将功能整合进上述要求中）：
>   1. （2分）发行一个 ERC20 合约，允许用户领取 ERC20 积分，并使用ERC20积分完成上述流程。
>   2. （3分）对交易彩票的过程实现一个简单的链上订单簿：卖方用户可以以不同价格出售一种彩票，网页上显示当前订单簿的信息（多少价格有多少该彩票正在出售）。其他用户可以根据最优价格购买彩票。
> - 可以对上述需求进行合理更改和说明。请大家专注于功能实现，网站UI美观程度不纳入评分标准，能让用户能够舒适操作即可。

**以下内容为作业仓库的README.md中需要描述的内容。请根据自己的需要进行修改并提交。**

作业提交方式为：**提交视频文件**和**仓库的链接**到指定邮箱。

## 如何运行

### 🚀 快速启动（推荐）

使用自动化脚本一键启动完整环境：

```bash
# 首次使用：设置脚本执行权限
chmod +x setup-permissions.sh
./setup-permissions.sh

# 启动完整环境（包括 Hardhat 节点、合约部署、前端启动）
./reset-environment.sh

# 停止所有服务
./stop-services.sh
```

### 📋 手动启动步骤

如果需要手动控制每个步骤：

1. **启动 Hardhat 本地节点**
   ```bash
   cd contracts
   npx hardhat node
   ```

2. **安装合约依赖并部署**
   ```bash
   cd contracts
   npm install
   npx hardhat compile
   npx hardhat run scripts/deploy.ts --network localhost
   ```

3. **启动前端应用**
   ```bash
   cd frontend
   npm install
   npm start
   ```

4. **配置 MetaMask**
   - 网络名称: Hardhat Local
   - RPC URL: http://127.0.0.1:8545
   - 链 ID: 31337
   - 货币符号: ETH

### 🔄 环境重置

如果遇到数据缓存问题，请按以下步骤完全重置：

1. **停止所有服务**
   ```bash
   ./stop-services.sh
   ```

2. **清理浏览器缓存**
   - Chrome/Edge: F12 → Network → 右键 → Clear browser cache
   - Firefox: F12 → 网络 → 设置 → 清空缓存

3. **重置 MetaMask 账户**
   ```
   MetaMask → 设置 → 高级 → 重置账户
   ```

4. **重新启动环境**
   ```bash
   ./reset-environment.sh
   ```

💡 **详细清理指南**: 如需更全面的数据清理方法，请参考 [CLEANUP_GUIDE.md](./CLEANUP_GUIDE.md)

### 🛠️ 故障排除

- **合约未部署**: 确保 Hardhat 节点正在运行，重新执行部署脚本
- **前端连接失败**: 检查 MetaMask 网络配置，确保连接到 Hardhat 本地网络
- **交易失败**: 在 MetaMask 中重置账户，清除交易历史
- **页面显示异常**: 清理浏览器缓存，强制刷新页面 (Ctrl+Shift+R)

详细测试指南请参考 [TESTING_GUIDE.md](./TESTING_GUIDE.md)

## 功能实现分析

简单描述：项目完成了要求的哪些功能？每个功能具体是如何实现的？

建议分点列出。

## 项目运行截图

放一些项目运行截图。

项目运行成功的关键页面和流程截图。主要包括操作流程以及和区块链交互的截图。

## 参考内容

- 课程的参考Demo见：[DEMOs](https://github.com/LBruyne/blockchain-course-demos)。

- 快速实现 ERC721 和 ERC20：[模版](https://wizard.openzeppelin.com/#erc20)。记得安装相关依赖 ``"@openzeppelin/contracts": "^5.0.0"``。

- 如何实现ETH和ERC20的兑换？ [参考讲解](https://www.wtf.academy/en/docs/solidity-103/DEX/)

如果有其它参考的内容，也请在这里陈列。
